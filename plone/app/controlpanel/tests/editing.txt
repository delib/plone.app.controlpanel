Editing control panel
=====================

Test setup::

    >>> app = layer['app']
    >>> from plone.testing.z2 import Browser
    >>> browser = Browser(app)
    >>> browser.handleErrors = False
    >>> browser.addHeader('Authorization', 'Basic admin:secret')
    >>> portal = layer['portal']

First some initial setup code:

    >>> from zope.component import getUtility
    >>> from Products.CMFCore.interfaces import IPropertiesTool
    >>> ptool = getUtility(IPropertiesTool)

Viewing the site control panel
-----------------------------

    >>> browser.open('http://nohost/plone/@@editing-controlpanel')
    >>> browser.url
    'http://nohost/plone/@@editing-controlpanel'

Click the cancel button:

    >>> browser.getControl(name="form.buttons.cancel").click()
    >>> browser.url.endswith('plone_control_panel')
    True

There should be still no changes:

    >>> 'Changes canceled.' in browser.contents
    True


Configure the locking for the site
----------------------------------

Standard behavior for locking is to have it enabled. Let's change that:

    >>> browser.open('http://nohost/plone/@@editing-controlpanel')
    >>> browser.getControl(name='form.widgets.lock_on_ttw_edit:list').value
    ['selected']
    >>> browser.getControl(name='form.widgets.lock_on_ttw_edit:list').value = False
    >>> browser.getControl(name="form.buttons.save").click()
    >>> browser.url.endswith('editing-controlpanel')
    True

Confirm that our change updated the property:

    >>> ptool.site_properties.lock_on_ttw_edit
    False
